<File version="2.1">
  <FileID>bfb97cdc-2237-45d5-93ca-6a8e83fee492</FileID>
  <Preview>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
tbVYWFiIiYkJSZK2TK1WK5aXl+tz7KNn2+PWZz4AHiynr3/96/HEE09IkrQlevLJJ+OrX/1q7Ny5
M37/+99/6Gx7HPtcBsCtW7fi29/+dhw6dCja29slSXrkO378eGzfvj2ee+65qHzwbHsc+1wGwO3b
t+sBsG/fvti/f78kSY98bW1t8YMf/CCef/55A+CTGACSpMctA8AAkCQlzAAwACRJCTMADABJUsIM
AANAkpQwA8AAkCQlzAAwACRJCTMADABJUsIMAANAkpQwA8AAkCQlzAAwACRJCTMADABJUsIMAANA
kpQwA8AAkCQlzAAwACRJCTMADABJUsIMAANAkpQwA8AAkCQlzAAwACRJCTMADABJUsIMAANAkpQw
A8AAkCQlzAAwACRJCTMADABJUsIMAANAkpQwA8AAkCQlzAAwACRJCTMADABJUsIMAANAkpQwA8AA
kCQlzAAwACRJCTMADABJUsIMAANAkpQwA8AAkCQlzAAwACRJCTMADABJUsIMAANAkpQwA8AAkCQl
zAAwACRJCTMADABJUsIMAANAkpQwA8AAkCQlzAAwACRJCTMADABJUsIMAANAkpQwA8AAkCQlzAAw
ACRJCTMADABJUsIMAANAkpQwA8AAkCQlzAAwACRJCTMADABJUsIMAANAkpQwA8AAkCQlzAAwACRJ
CTMADABJUsIMAANAkpQwA8AAkCQlzAAwACRJCTMADABJUsIMAANAkpQwA8AAkCQlzAAwACRJCTMA
DABJUsIMAANAkpQwA8AAkCQlzAAwACRJCTMADABJUsIMAANAkpQwA8AAkCQlzAAwACRJCTMADABJ
UsIMAANAkpQwA8AAkCQlzAAwACRJCTMADABJUsIMAANAkpQwA8AAkCQlzAAwACRJCTMADABJUsIM
AANAkpQwA8AAkCQlzAAwACRJCTMADABJUsIMAANAkpQwA8AAkCQlzAAwACRJCTMADABJUsIMAANA
kpQwA8AAkCQlzAAwACRJCTMADABJUsIMAANAkpQwA8AAkCQlzAAwACRJCTMADABJUsIMAANAkpQw
A8AAkCQlzAAwACRJCTMADABJUsIMAANAkpQwA8AAkCQlzAAwACRJCTMADABJUsIMAANAkpQwA8AA
kCQlzAAwACRJCTMADABJUsIMAANAkpQwA8AAkCQlzAAwACRJCTMADABJUsIMAANAkpQwA8AAkCQl
zAAwACRJCTMADABJUsIMAANAkpQwA8AAkCQlzAAwACRJCTMADABJUsIMAANAkpQwA8AAkCQlzAAw
ACRJCTMADABJUsIMAANAkpQwA8AAkCQlzAAwACRJCTMADABJUsIMAANAkpQwA8AAkCQlzAAwACRJ
CTMADABJUsIMAANAkpQwA8AAkCQlzAAwACRJCTMADABJUsIMAANAkpQwA8AAkCQlzAAwACRJCTMA
DABJUsIMAANAkpQwA8AAkCQlzAAwACRJCTMADABJUsIMAANAkpQwA8AAkCQlzAAwACRJCTMADABJ
UsIMAANAkpQwA8AAkCQlzAAwACRJCTMADABJUsIMAANAkpQwA8AAkCQlzAAwACRJCTMADABJUsIM
AANAkpQwA8AAkCQlzAAwACRJCTMADABJUsIMAANAkpQwA8AAkCQlzAAwACRJCTMADABJUsIMAANA
kpQwA8AAkCQlzAAwACRJCTMADABJUsIMAANAkpQwA8AAkCQlzAAwACRJCTMADABJUsIMAANAkpQw
A8AAkCQlzAAwACRJCTMADABJUsIMAANAkpQwA8AAkCQlzAAwACRJCTMADABJUsIMAANAkpQwA8AA
kCQlzAAwACRJCTMADABJUsIMAANAkpQwA8AAkCQlzAAwACRJCTMADABJUsIMAANAkpQwA8AAkCQl
zAAwACRJCTMADABJUsIMAANAkpQwA8AAkCQlzAAwACRJCTMADABJUsIMAANAkpQwA8AAkCQlzAAw
ACRJCTMADABJUsIMAANAkpQwA8AAkCQlzAAwACRJCTMADABJUsIMAANAkpQwA8AAkCQlzAAwACRJ
CTMADABJUsIMAANAkpQwA8AAkCQlzAAwACRJCTMADABJUsIMAANAkpQwA8AAkCQlzAAwACRJCTMA
DABJUsIMAANAkpQwA8AAkCQlzAD4jAbAk08+GQcPHqz/D5Uk6VGv0WjE9u3bDYA/5mED4O7du/G1
r30tvv/979drSpKkR73q8P/GN74RzzzzjAHwSf7YAFhbW6tHQPX2/wsvvCBJ0papevU/Ojoa9+7d
+9DZ9jj2mQ+AB7333nv1ggKAreTXv/51rKysfOzZ9jj1uQ0ASZL06GYASJKUsM9kAFQPIkmStk7v
rK/GrbufcgDMlAFwbmk9lssDSJKkrVN1+F+79SkHwOy19brqZkmStHWarj7eP8c3PQC2/+iZYyu/
i/oGSZK0tVt6J2J8euHhA+B7//bvPTMXFstamKsXgyRJ2rpVh//xzubDBwAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANu2bdv2
PwKKG+PCrIRLAAAAAElFTkSuQmCC</Preview>
  <Object type="System.Windows.Forms.Form, System.Windows.Forms, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" name="form1" children="Controls">
    <Property name="AutoScaleDimensions">6, 13</Property>
    <Property name="AutoScaleMode">Font</Property>
    <Property name="ClientSize">1114, 579</Property>
    <Property name="Name">form1</Property>
    <Property name="Text">Form</Property>
    <Event name="Load">form1_Load</Event>
    <Object type="System.Windows.Forms.DataGridView, System.Windows.Forms, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" name="datagridview1" children="Controls">
      <Property name="AutoSizeColumnsMode">DisplayedCells</Property>
      <Property name="AutoSizeRowsMode">DisplayedCells</Property>
      <Property name="ColumnHeadersHeightSizeMode">AutoSize</Property>
      <Property name="ContextMenuStrip">
        <Reference name="contextmenustrip1" />
      </Property>
      <Property name="Location">12, 65</Property>
      <Property name="MultiSelect">False</Property>
      <Property name="Name">datagridview1</Property>
      <Property name="RowHeadersWidthSizeMode">AutoSizeToFirstHeader</Property>
      <Property name="SelectionMode">FullRowSelect</Property>
      <Property name="Size">969, 502</Property>
      <Property name="TabIndex">0</Property>
    </Object>
  </Object>
  <Object type="System.Windows.Forms.ContextMenuStrip, System.Windows.Forms, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" name="contextmenustrip1" children="Controls">
    <Property name="Items">
      <Item type="System.Windows.Forms.ToolStripMenuItem, System.Windows.Forms, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">
        <Reference name="shadowToolStripMenuItem" />
      </Item>
      <Item type="System.Windows.Forms.ToolStripSeparator, System.Windows.Forms, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">
        <Reference name="toolstripseparator1" />
      </Item>
      <Item type="System.Windows.Forms.ToolStripMenuItem, System.Windows.Forms, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">
        <Reference name="asdfToolStripMenuItem" />
      </Item>
    </Property>
    <Property name="Name">contextmenustrip1</Property>
    <Property name="Size">117, 54</Property>
    <Property name="Text">S</Property>
  </Object>
  <Object type="System.Windows.Forms.ToolStripMenuItem, System.Windows.Forms, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" name="asdfToolStripMenuItem">
    <Property name="Name">asdfToolStripMenuItem</Property>
    <Property name="Size">116, 22</Property>
    <Property name="Text">Kick</Property>
    <Event name="Click">asdfToolStripMenuItem_Click</Event>
  </Object>
  <Object type="System.Windows.Forms.ToolStripMenuItem, System.Windows.Forms, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" name="shadowToolStripMenuItem">
    <Property name="Name">shadowToolStripMenuItem</Property>
    <Property name="Size">116, 22</Property>
    <Property name="Text">Shadow</Property>
    <Event name="Click">shadowToolStripMenuItem_Click</Event>
  </Object>
  <Object type="System.Windows.Forms.ToolStripSeparator, System.Windows.Forms, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" name="toolstripseparator1">
    <Property name="Name">toolstripseparator1</Property>
    <Property name="Size">113, 6</Property>
  </Object>
  <Object type="System.Windows.Forms.Timer, System.Windows.Forms, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" name="timer1">
    <Property name="Enabled">True</Property>
    <Property name="Interval">60000</Property>
  </Object>
  <Code><![CDATA[
$form1_Load={
	#TODO: Initialize Form Controls here
	
	[pscustomobject]$output = @()
	
	Refresh-Grid
	
	$RDSusers = get-rdusersession -connectionbroker "rds-cb-wa.ad.humboldt.edu" | where-object { $_.CollectionName -match "ITS*" }
	
	foreach ($user in $RDSusers)
	{
		
		$tempUser = get-aduser $user.UserName -Properties DisplayName
		
		$singleUser = [pscustomobject]@{
			
			UserName    = $user.UserName
			FullName	 = $tempUser.DisplayName
			LogOnTime = $user.CreateTime
			SessionState = $user.SessionState
			HostServer   = $user.HostServer
			SessionID = $user.UnifiedSessionId
			
		}
		
		$output += $singleUser
		
	}
	
	
	$outputConverted = ConvertTo-DataTable -InputObject $output
	
	Update-DataGridView -DataGridView $datagridview1 -Item $outputConverted
	
}

#region Control Helper Functions
function Update-DataGridView
{
	<#
	.SYNOPSIS
		This functions helps you load items into a DataGridView.

	.DESCRIPTION
		Use this function to dynamically load items into the DataGridView control.

	.PARAMETER  DataGridView
		The DataGridView control you want to add items to.

	.PARAMETER  Item
		The object or objects you wish to load into the DataGridView's items collection.
	
	.PARAMETER  DataMember
		Sets the name of the list or table in the data source for which the DataGridView is displaying data.

	.PARAMETER AutoSizeColumns
	    Resizes DataGridView control's columns after loading the items.
	#>
	Param (
		[ValidateNotNull()]
		[Parameter(Mandatory=$true)]
		[System.Windows.Forms.DataGridView]$DataGridView,
		[ValidateNotNull()]
		[Parameter(Mandatory=$true)]
		$Item,
	    [Parameter(Mandatory=$false)]
		[string]$DataMember,
		[System.Windows.Forms.DataGridViewAutoSizeColumnMode]$AutoSizeColumns = 'None'
	)
	$DataGridView.SuspendLayout()
	$DataGridView.DataMember = $DataMember
	
	if ($Item -is [System.Data.DataSet] -and $Item.Tables.Count -gt 0)
	{
		$DataGridView.DataSource = $Item.Tables[0]
	}
	elseif ($Item -is [System.ComponentModel.IListSource]`
	-or $Item -is [System.ComponentModel.IBindingList] -or $Item -is [System.ComponentModel.IBindingListView] )
	{
		$DataGridView.DataSource = $Item
	}
	else
	{
		$array = New-Object System.Collections.ArrayList
		
		if ($Item -is [System.Collections.IList])
		{
			$array.AddRange($Item)
		}
		else
		{
			$array.Add($Item)
		}
		$DataGridView.DataSource = $array
	}
	
	if ($AutoSizeColumns -ne 'None')
	{
		$DataGridView.AutoResizeColumns($AutoSizeColumns)
	}
	
	$DataGridView.ResumeLayout()
}

function ConvertTo-DataTable
{
	<#
		.SYNOPSIS
			Converts objects into a DataTable.
	
		.DESCRIPTION
			Converts objects into a DataTable, which are used for DataBinding.
	
		.PARAMETER  InputObject
			The input to convert into a DataTable.
	
		.PARAMETER  Table
			The DataTable you wish to load the input into.
	
		.PARAMETER RetainColumns
			This switch tells the function to keep the DataTable's existing columns.
		
		.PARAMETER FilterWMIProperties
			This switch removes WMI properties that start with an underline.
	
		.EXAMPLE
			$DataTable = ConvertTo-DataTable -InputObject (Get-Process)
	#>
	[OutputType([System.Data.DataTable])]
	param(
	[ValidateNotNull()]
	$InputObject, 
	[ValidateNotNull()]
	[System.Data.DataTable]$Table,
	[switch]$RetainColumns,
	[switch]$FilterWMIProperties)
	
	if($null -eq $Table)
	{
		$Table = New-Object System.Data.DataTable
	}
	
	if ($InputObject -is [System.Data.DataTable])
	{
		$Table = $InputObject
	}
	elseif ($InputObject -is [System.Data.DataSet] -and $InputObject.Tables.Count -gt 0)
	{
		$Table = $InputObject.Tables[0]
	}
	else
	{
		if (-not $RetainColumns -or $Table.Columns.Count -eq 0)
		{
			#Clear out the Table Contents
			$Table.Clear()
			
			if ($null -eq $InputObject) { return } #Empty Data
			
			$object = $null
			#find the first non null value
			foreach ($item in $InputObject)
			{
				if ($null -ne $item)
				{
					$object = $item
					break
				}
			}
			
			if ($null -eq $object) { return } #All null then empty
			
			#Get all the properties in order to create the columns
			foreach ($prop in $object.PSObject.Get_Properties())
			{
				if (-not $FilterWMIProperties -or -not $prop.Name.StartsWith('__')) #filter out WMI properties
				{
					#Get the type from the Definition string
					$type = $null
					
					if ($null -ne $prop.Value)
					{
						try { $type = $prop.Value.GetType() }
						catch { Out-Null }
					}
					
					if ($null -ne $type) # -and [System.Type]::GetTypeCode($type) -ne 'Object')
					{
						[void]$table.Columns.Add($prop.Name, $type)
					}
					else #Type info not found
					{
						[void]$table.Columns.Add($prop.Name)
					}
				}
			}
			
			if ($object -is [System.Data.DataRow])
			{
				foreach ($item in $InputObject)
				{
					$Table.Rows.Add($item)
				}
				return @( ,$Table)
			}
		}
		else
		{
			$Table.Rows.Clear()
		}
		
		foreach ($item in $InputObject)
		{
			$row = $table.NewRow()
			
			if ($item)
			{
				foreach ($prop in $item.PSObject.Get_Properties())
				{
					if ($table.Columns.Contains($prop.Name))
					{
						$row.Item($prop.Name) = $prop.Value
					}
				}
			}
			[void]$table.Rows.Add($row)
		}
	}
	
	return @(,$Table)	
}
#endregion


$asdfToolStripMenuItem_Click={
	#TODO: Place custom script here
	
	$sessionHost = $datagridview1.CurrentRow.Cells["HostServer"].Value.ToString()
	$ID = $datagridview1.CurrentRow.Cells["SessionID"].Value.ToString()
	
	Invoke-RDUserLogoff -HostServer $sessionHost -UnifiedSessionID $ID -Force
	


}


$shadowToolStripMenuItem_Click={
	#TODO: Place custom script here
	
	$sessionHost = $datagridview1.CurrentRow.Cells["HostServer"].Value.ToString()
	$ID = $datagridview1.CurrentRow.Cells["SessionID"].Value.ToString()
	
	
	$arguments = "/v:$($sessionHost) /shadow:$($ID) /control /noConsentPrompt /public"
	start-process mstsc.exe -ArgumentList $arguments
	
	
}
]]></Code>
  <Mode>1</Mode>
  <Assemblies>
    <Assembly>mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</Assembly>
    <Assembly>System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</Assembly>
    <Assembly>System.Windows.Forms, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</Assembly>
    <Assembly>System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</Assembly>
    <Assembly>System.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a</Assembly>
    <Assembly>System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</Assembly>
    <Assembly>System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</Assembly>
  </Assemblies>
</File>